if (self.CavalryLogger) { CavalryLogger.start_js(["H\/9Of"]); }

__d("JSLoggerImpl",["Arbiter","AsyncRequest","Banzai","BanzaiODS","Env","ErrorUtils","JSLogger","JSLoggerConfig","SystemEvents","emptyFunction","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("BanzaiODS").create(),i=c("JSLogger")._,j,k="/ajax/chat/jslogger.php",l=c("JSLogger").create("jslogger"),m=-1,n=null,o={enabled_categories:null,categories:null,send_min:7500,send_max:6e4};function p(z){return c("JSLoggerConfig")[z]||o[z]}function q(z){var A=p("enabled_categories")||{},B=z in A?A[z]:A.__default;return B}function r(z,A,event){}function s(x){if(console&&console[x.type]&&n&&n.test(x.cat)){var z=/(\d\d:\d\d:\d\d)/.test(new Date(x.date))&&RegExp.$1,A=z+" "+x.cat+":"+x.event;if(x.data)console[x.type](A,JSON.parse(x.data));else console[x.type](A)}}function t(z){__p&&__p();var A={page_id:i.pageId,env_start:c("Env").start,now:Date.now()};if(z){c("Arbiter").inform(c("JSLogger").DUMP_EVENT,z);A.dumpData=z;A.log=c("JSLogger").getEntries()}else{A.log=c("JSLogger").getEntries(function(x){return/log|warn|error/.test(x.type)&&q(x.cat)},j);j=i.head;A.counts=i.counts;i.counts={}}return A}function u(z,A,B){__p&&__p();var C=t(z);if(!z){var D=false;for(var E in C.counts)D=D||E!="jslogger";if(!D&&C.log.length<=0)return}if(c("Banzai").isEnabled("jslogger")){delete C.counts;c("Banzai").post("jslogger",C,{delay:0});h.flush()}else{C=JSON.stringify(C);var F=new(c("AsyncRequest"))().setURI(k+(z?"?dump=1":"")).setMethod("POST").setData({clientState:C}).setReadOnly(true).setAllowCrossPageTransition(true);if(A)F.setHandler(A);F.setErrorHandler(B||c("emptyFunction"));F.send()}}function v(){var z=p("send_min"),A=p("send_max"),B=z*Math.pow(2,m+1);if(m>=0&&!i.forwarding){l.bump("send_t"+(B<=A?m:"max"));u()}m++;B*=.75+Math.random()/2;c("setTimeoutAcrossTransitions")(v,B)}var w=i.logAction;i.logAction=function(event,z,A){__p&&__p();r(this.type,this.cat,event);var x=w.apply(this,arguments);if(c("Banzai").isEnabled("jslogger"))if(this.type=="bump")h.bumpEntityKey(this.cat,event,z);else if(this.type=="rate")h.bumpFraction(this.cat,event,z?A:0,A);if(x){s(x);while(j&&i.head.seq-j.seq>i.MAX_HISTORY){j=j.next;l.bump("dropped_entries")}}};Object.assign(c("JSLogger"),{setConsoleFilter:function z(A){if(!(A instanceof RegExp))A=A?new RegExp(A):null;n=A},replay:function z(){for(var x=i.tail;x;x=x.next)s(x)},getDumpJSON:function z(A){return t({})},submitDump:function z(A,B){u(A||{},function(C){var D=C.getPayload();B(D)},function(){B(null)})},dump:function z(A){this.submitDump(A,function(B){if(B)prompt("JSLogger dump now available at:",B);else alert("Error while sending JSLogger dump")})}});v();for(var x=i.tail;x;x=x.next)s(x);var y=c("JSLogger").create("sys");c("ErrorUtils").addListener(function(z){if(z.message=="Script error."){y.bump("xdomain_error");y.debug("xdomain_error")}else y.error("uncaught_exception",z)});c("SystemEvents").subscribe(c("SystemEvents").ONLINE,function(z,A){y.warn(A?"online":"offline")});c("SystemEvents").subscribe(c("SystemEvents").USER,function(z,A){y.warn("user",{user:A})});c("SystemEvents").subscribe(c("SystemEvents").TIME_TRAVEL,function(z,A){y.warn("time_travel",{dt:A})})}),null);